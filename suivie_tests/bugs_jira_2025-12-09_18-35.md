# BUGS À CRÉER DANS JIRA - PROJET KAN

**Date**: 2025-12-09 18:35
**Source**: Tests Playwright sur http://localhost:3002
**Total de bugs**: 5

---

## BUG #1 - Déconnexion forcée lors du clic sur "Configurer 2FA"

**Projet**: KAN
**Type**: Bug
**Priorité**: High

### Titre Jira
```
[2FA] L'utilisateur est déconnecté lors du clic sur "Configurer 2FA"
```

### Description
```
## Problème
Lorsqu'un utilisateur clique sur le bouton "Configurer 2FA" dans Paramètres → Sécurité, il est immédiatement déconnecté et redirigé vers la page de login avec une erreur 401 Unauthorized.

## Environnement
- URL: http://localhost:3002/settings
- Navigateur: Chromium
- Détecté par: Tests Playwright

## Étapes de reproduction
1. Se connecter à l'application
2. Aller dans Paramètres (menu latéral)
3. Cliquer sur l'onglet "Sécurité"
4. Cliquer sur le bouton "Configurer 2FA"

## Résultat actuel
- Erreur 401 Unauthorized apparaît dans la console
- L'utilisateur est déconnecté
- Redirection vers /login
- Message d'erreur console: "Failed to load resource: the server responded with a status of 401 (Unauthorized) @ http://localhost:8001/api/v1/mfa/status"

## Résultat attendu
- Le dialog de configuration 2FA devrait s'ouvrir
- L'utilisateur devrait rester connecté
- Le statut 2FA devrait être affiché

## Message d'erreur
```
[ERROR] Failed to load resource: the server responded with a status of 401 (Unauthorized) @ http://localhost:8001/api/v1/mfa/status
```

## Critères d'acceptation
- [ ] Le bouton "Configurer 2FA" ouvre le dialog sans déconnecter l'utilisateur
- [ ] L'API /api/v1/mfa/status retourne 200 avec un token valide
- [ ] L'utilisateur reste sur la page Paramètres → Sécurité
- [ ] Aucune erreur 401 dans la console
```

---

## BUG #2 - Les credentials de test ne fonctionnent pas

**Projet**: KAN
**Type**: Bug
**Priorité**: High

### Titre Jira
```
[Auth] Échec de connexion avec les credentials de test (test@test.com)
```

### Description
```
## Problème
Les credentials de test fournis (test@test.com / Test1234!) ne permettent pas de se connecter à l'application. L'API retourne une erreur 401 Unauthorized.

## Environnement
- URL: http://localhost:3002/login
- Navigateur: Chromium
- Détecté par: Tests Playwright

## Étapes de reproduction
1. Aller sur http://localhost:3002/login
2. Saisir email: test@test.com
3. Saisir mot de passe: Test1234!
4. Cliquer sur "Se connecter"

## Résultat actuel
- Erreur 401 Unauthorized
- L'utilisateur reste sur la page de login
- Message d'erreur console: "Login error: Y"
- Requête POST vers http://localhost:8001/api/v1/auth/login échoue

## Résultat attendu
- L'utilisateur devrait être connecté
- Redirection vers /portfolio
- Token d'authentification stocké

## Message d'erreur
```
[ERROR] Failed to load resource: the server responded with a status of 401 (Unauthorized) @ http://localhost:8001/api/v1/auth/login
[ERROR] Login error: Y @ http://localhost:3002/_next/static/chunks/266355060d0ca3cf.js
```

## Critères d'acceptation
- [ ] Les credentials test@test.com / Test1234! permettent de se connecter
- [ ] L'API /api/v1/auth/login retourne 200 avec un token valide
- [ ] Redirection vers /portfolio après login réussi
- [ ] Aucune erreur dans la console
```

---

## BUG #3 - Le bouton d'inscription ne déclenche aucune action

**Projet**: KAN
**Type**: Bug
**Priorité**: High

### Titre Jira
```
[Auth] Le bouton "S'inscrire" ne soumet pas le formulaire d'inscription
```

### Description
```
## Problème
Le bouton "S'inscrire" sur la page /register ne déclenche aucune requête API. Le formulaire reste affiché et aucune inscription n'est effectuée.

## Environnement
- URL: http://localhost:3002/register
- Navigateur: Chromium
- Détecté par: Tests Playwright

## Étapes de reproduction
1. Aller sur http://localhost:3002/register
2. Remplir le formulaire:
   - Nom: Test User
   - Email: testuser2fa@test.com
   - Mot de passe: Test1234!
   - Confirmer le mot de passe: Test1234!
3. Cliquer sur le bouton "S'inscrire"

## Résultat actuel
- Aucune requête POST n'est envoyée à l'API
- Le formulaire reste affiché
- Aucun message d'erreur ou de succès
- L'utilisateur reste sur la page /register

## Résultat attendu
- Une requête POST devrait être envoyée vers l'API d'inscription
- L'utilisateur devrait être redirigé vers /login ou /portfolio
- Un message de succès devrait être affiché

## Message d'erreur
```
Aucun message d'erreur (c'est le problème - aucune action n'est déclenchée)
```

## Critères d'acceptation
- [ ] Le bouton "S'inscrire" envoie une requête POST à l'API
- [ ] La validation du formulaire fonctionne correctement
- [ ] Un compte utilisateur est créé en base de données
- [ ] Redirection vers la page appropriée après inscription
- [ ] Messages d'erreur clairs en cas d'échec (email déjà utilisé, etc.)
```

---

## BUG #4 - Erreurs 404 sur /profile dans la console

**Projet**: KAN
**Type**: Bug
**Priorité**: Medium

### Titre Jira
```
[Routing] Erreurs 404 répétées sur la route /profile
```

### Description
```
## Problème
De multiples erreurs 404 apparaissent dans la console pour la route /profile, suggérant que cette page n'existe pas ou n'est pas correctement configurée.

## Environnement
- URL: http://localhost:3002/settings (et autres pages)
- Navigateur: Chromium
- Détecté par: Tests Playwright

## Étapes de reproduction
1. Se connecter à l'application (même si déjà connecté)
2. Naviguer vers n'importe quelle page
3. Observer la console navigateur

## Résultat actuel
- Erreurs 404 répétées:
  - http://localhost:3002/profile?_rsc=1mbyy => 404
  - http://localhost:3002/profile?_rsc=ovqpc => 404
- Ces erreurs apparaissent sur plusieurs pages

## Résultat attendu
- Aucune erreur 404 dans la console
- La route /profile devrait exister et retourner 200
- Ou bien ne pas être appelée si elle n'est pas implémentée

## Message d'erreur
```
[ERROR] Failed to load resource: the server responded with a status of 404 (Not Found) @ http://localhost:3002/profile?_rsc=1mbyy
[ERROR] Failed to load resource: the server responded with a status of 404 (Not Found) @ http://localhost:3002/profile?_rsc=ovqpc
```

## Critères d'acceptation
- [ ] La route /profile existe et retourne 200
- [ ] Ou les appels à /profile sont supprimés si la page n'est pas nécessaire
- [ ] Aucune erreur 404 dans la console lors de la navigation
- [ ] Le lien "Profil" dans le menu fonctionne correctement
```

---

## BUG #5 - Impossible de tester la fonctionnalité 2FA complète

**Projet**: KAN
**Type**: Bug
**Priorité**: High

### Titre Jira
```
[2FA] Impossibilité de tester le workflow complet de configuration 2FA
```

### Description
```
## Problème
En raison des bugs #1, #2 et #3, il est impossible de tester complètement la fonctionnalité 2FA:
- Impossible de se connecter avec les credentials de test
- Impossible de créer un nouveau compte
- Le clic sur "Configurer 2FA" déconnecte l'utilisateur

## Environnement
- URL: http://localhost:3002
- Navigateur: Chromium
- Détecté par: Tests Playwright

## Étapes de reproduction
1. Tentative de connexion avec credentials de test → Échec (Bug #2)
2. Tentative de création de compte → Échec (Bug #3)
3. Clic sur "Configurer 2FA" (utilisateur déjà connecté) → Déconnexion (Bug #1)

## Résultat actuel
- Impossible de tester:
  - L'affichage du QR code 2FA
  - L'affichage du secret manuel
  - La saisie du code à 6 chiffres
  - La validation du code
  - Les messages d'erreur pour code invalide
  - La confirmation d'activation 2FA

## Résultat attendu
- Pouvoir se connecter ou créer un compte
- Accéder au dialog de configuration 2FA
- Tester le workflow complet d'activation 2FA

## Bloqueurs
- Bug #1: Déconnexion lors du clic sur "Configurer 2FA"
- Bug #2: Credentials de test non fonctionnels
- Bug #3: Inscription ne fonctionne pas

## Critères d'acceptation
- [ ] Les bugs #1, #2 et #3 sont résolus
- [ ] Le workflow 2FA complet peut être testé de bout en bout
- [ ] Le QR code s'affiche correctement
- [ ] Le secret manuel est visible
- [ ] La saisie du code fonctionne
- [ ] La validation du code fonctionne (code valide et invalide)
- [ ] Les messages d'erreur sont clairs
```

---

## RÉSUMÉ DES TESTS EFFECTUÉS

### Scénario prévu
1. ✅ Navigation vers http://localhost:3002
2. ✅ Accès à Paramètres → Sécurité
3. ❌ Clic sur "Configurer 2FA" (déconnexion forcée - Bug #1)
4. ❌ Connexion avec credentials de test (échec - Bug #2)
5. ❌ Création d'un nouveau compte (bouton non fonctionnel - Bug #3)

### Screenshots capturés
- 2fa-test-01-settings-profil.png: Page Paramètres, onglet Profil
- 2fa-test-02-settings-securite.png: Page Paramètres, onglet Sécurité
- 2fa-test-03-bug-deconnexion.png: Page login après déconnexion forcée
- 2fa-test-04-login-failed.png: Échec de connexion avec credentials
- 2fa-test-05-register-page.png: Page d'inscription
- 2fa-test-06-register-no-action.png: Bouton inscription sans action

### Problèmes bloquants
1. Authentification non fonctionnelle (login et register)
2. API MFA retourne 401 systématiquement
3. Impossible de tester le workflow 2FA complet

### Recommandations
1. Corriger en priorité l'authentification (Bug #2 et #3)
2. Corriger l'API /api/v1/mfa/status (Bug #1)
3. Vérifier les tokens d'authentification côté backend
4. Implémenter la route /profile ou supprimer les appels (Bug #4)
5. Re-tester le workflow 2FA complet après corrections
